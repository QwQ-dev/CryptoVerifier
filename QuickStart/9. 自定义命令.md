# ğŸš€ CryptoVerifier

---

## è‡ªå®šä¹‰éªŒè¯å™¨

é€šå¸¸æ¥è¯´æ‚¨ä¸å¿…ç‰¹æ„å†™æ£€æµ‹åŠ å¼ºéªŒè¯æµç¨‹ï¼Œä½†æ˜¯ CryptoVerifier ä¾ç„¶æä¾›ç›¸åº” APIï¼Œä»¥ä¾›æ‚¨å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½è¿›è¡Œåº”æ€¥å“åº”ç­‰ã€‚

---

## éªŒè¯å™¨å…¥å£

éªŒè¯å™¨å…¥å£åº”å®ç° Validator æ¥å£å¹¶é‡å†™æ‰€æœ‰æ–¹æ³•ã€‚

```java
/**
 * éªŒè¯å™¨æ¥å£ï¼Œæ‰€æœ‰éªŒè¯å™¨ç±»éƒ½åº”å®ç°æ­¤æ¥å£ï¼Œå¹¶é‡å†™æ‰€æœ‰æ–¹æ³•ã€‚
 *
 * @author 2000000
 * @version 1.1
 * @since 2023/7/14
 */
public interface Validator {
    /**
     * éªŒè¯æ–¹æ³•ã€‚
     *
     * <p>
     * æ³¨æ„ï¼Œæ­¤å¤„çš„ {@code serverVerifierDataObject} ä¼šæŒç»­æ›´æ–°ï¼Œ
     * ä¿è¯ä¸‹ä¸€ä¸ªéªŒè¯å™¨æ”¶åˆ°çš„æ˜¯ä¸Šä¸€ä¸ªéªŒè¯å™¨è¿”å›çš„æœ€æ–°æ•°æ®ã€‚ä½†çœŸæ­£çš„ IO æ“ä½œåªæœ‰æ‰€æœ‰éªŒè¯é€šè¿‡æ‰ä¼šè¿›è¡Œã€‚
     * </p>
     *
     * @param ip                              å®¢æˆ·ç«¯ IP åœ°å€
     * @param credentialData                  å‡­è¯æ•°æ®å¯¹è±¡
     * @param clientVerifierDataObject        å®¢æˆ·ç«¯éªŒè¯æ•°æ®å¯¹è±¡
     * @param serverVerifierDataObject        æœåŠ¡å™¨éªŒè¯æ•°æ®å¯¹è±¡
     * @return éªŒè¯ç»“æœ
     */
    boolean validate(String ip, CredentialData credentialData, Object clientVerifierDataObject, Object serverVerifierDataObject) throws Exception;

    /**
     * æƒé‡ï¼Œè¶Šä½è¶Šå…ˆæ‰§è¡Œã€‚
     *
     * <p>
     * èŒƒå›´åœ¨ {@code 20} ~ {@code 10000} ä¹‹é—´ã€‚
     * </p>
     *
     * <p>
     * è™½ç„¶æ‚¨å¯ä»¥æ³¨å†Œ {@code 20} ä»¥ä¸‹çš„æƒé‡ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨æœŸé—´ï¼Œæˆ‘æ°¸è¿œä¸ä¼šæ¨èæ‚¨è¿™ä¹ˆåšï¼Œé™¤éæ‚¨çœŸçš„çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆã€‚
     * </p>
     *
     * @return æƒé‡
     */
    int getWeight();

    /**
     * æ˜¯å¦å¿½ç•¥å¼‚å¸¸ã€‚
     *
     * <p>
     * è‹¥ä¸ºçœŸï¼Œå½“ {@link Validator#validate(String, CredentialData, Object, Object)} )} å‡ºç°å¼‚å¸¸æ—¶ç›´æ¥è¿”å› {@link Validator#getFailedMessage()}ï¼Œå¦åˆ™å°†æ‰“å°å¼‚å¸¸åè¿”å›ã€‚
     * </p>
     *
     * @return æ˜¯å¦å¿½ç•¥å¼‚å¸¸
     */
    boolean isIgnoreException();

    /**
     * éªŒè¯å™¨åç§°ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * @return éªŒè¯å™¨åç§°
     */
    @NotNull
    String getName();

    /**
     * éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * <p>
     * æˆ‘ä»¬æ”¯æŒæ‚¨æ ¹æ®ä¸åŒçš„æ¡ä»¶åœ¨æ­¤å¤„è¿”å›ä¸åŒçš„ä¿¡æ¯ï¼Œä½†è¿™ç§åŠ¨æ€è¿”å›ä»…æ”¯æŒæ­¤æ–¹æ³•ä¸ {@link Validator#getServerVerifierData()} æ–¹æ³•ã€‚
     * å…¶ä½™æ–¹æ³•åŠ¨æ€è¿”å›å°†æ˜¯ä¸å®‰å…¨ä¸”ä¸æ¨èçš„åšæ³•ã€‚
     * </p>
     *
     * @return éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯
     */
    @NotNull
    String getFailedMessage();

    /**
     * å¯¹äºæ­¤éªŒè¯å™¨çš„æè¿°ã€‚
     *
     * @return æè¿°
     */
    String getDescription();

    /**
     * æœåŠ¡å™¨éªŒè¯æ•°æ®ã€‚
     *
     * <p>
     * å½“æ‚¨å°è¯•ä¿®æ”¹äº†æœåŠ¡å™¨éªŒè¯æ•°æ®æ—¶ï¼Œè¿™é‡Œå¿…é¡»ä¸ºæ‚¨ä¿®æ”¹åçš„å¯¹è±¡ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰ IO æ“ä½œã€‚
     * </p>
     *
     * <p>
     * è‹¥ä¸º {@code null} åˆ™ä¸ºæœªè¿›è¡Œä¿®æ”¹ï¼Œè‹¥æœªç©º {@code ""} åˆ™æœªåˆ é™¤è¯¥ç”¨æˆ·çš„æ•°æ®ã€‚
     * </p>
     *
     * @return æœåŠ¡å™¨éªŒè¯æ•°æ®
     */
    Object getServerVerifierData();
}
```

---

## ç¤ºä¾‹éªŒè¯å™¨

åœ¨ç¤ºä¾‹æ’ä»¶ä¸­æˆ‘ä»¬å·²ç»æä¾›äº†ç¤ºä¾‹ç›‘å¬å™¨çš„ç¼–å†™ï¼Œå¹¶æ³¨æ˜äº†æ‚¨åº”è¯¥æ³¨æ„çš„äº‹é¡¹ã€‚

```java
/**
 * ç¤ºä¾‹è‡ªå®šä¹‰éªŒè¯å™¨ï¼Œåº”å®ç° {@link Validator} é‡å†™æ‰€æœ‰æ–¹æ³•ã€‚
 *
 * <p>
 * æ­¤ç±»å°†å®ç°ä¸€ä¸ªç®€æ˜“çš„è‡ªå®šä¹‰éªŒè¯å™¨ä½œä¸ºç¤ºä¾‹ã€‚
 * </p>
 *
 * <p>
 * æ­¤éªŒè¯å°†å¯¹ä½¿ç”¨ IP è¿›è¡Œæ£€æŸ¥ï¼Œè‹¥å­˜åœ¨ {@code 127.0.0.1} åˆ™è¿›è¡Œåˆ é™¤å¹¶è¿”å› {@code false}ï¼Œå¿½ç•¥å¼‚å¸¸ã€‚
 * </p>
 *
 * @author 2000000
 * @version 1.1
 * @since 2023/7/14
 */
public class ExampleValidation implements Validator {
    /**
     * {@link ServerVerifierDataAPI} å¯¹è±¡ã€‚
     *
     * <p>
     * ç§æœ‰æˆå‘˜å˜é‡ï¼Œè¿™é‡Œå°†å…¶æå–å‡ºæ¥æ˜¯å› ä¸ºåœ¨ {@link Validator#validate(String, CredentialData, Object, Object)} )} æ–¹æ³•ä¸­
     * å¯¹ {@code serverVerifierDataObject} è¿›è¡Œäº†æ›´æ”¹ï¼Œéœ€è¦é€šè¿‡ {@link ExampleValidation#getServerVerifierData()} æ–¹æ³•è¿”å›æ–°æ•°æ®ï¼Œå‘ŠçŸ¥æœåŠ¡ç«¯æ›´æ–°æ•°æ®ã€‚
     * </p>
     */
    private ServerVerifierDataAPI serverVerifierDataAPI;

    /**
     * éªŒè¯æ–¹æ³•ã€‚
     *
     * <p>
     * æ³¨æ„ï¼Œæ­¤å¤„çš„ {@code serverVerifierDataObject} ä¼šæŒç»­æ›´æ–°ï¼Œ
     * ä¿è¯ä¸‹ä¸€ä¸ªéªŒè¯å™¨æ”¶åˆ°çš„æ˜¯ä¸Šä¸€ä¸ªéªŒè¯å™¨è¿”å›çš„æœ€æ–°æ•°æ®ã€‚ä½†çœŸæ­£çš„ IO æ“ä½œåªæœ‰æ‰€æœ‰éªŒè¯é€šè¿‡æ‰ä¼šè¿›è¡Œã€‚
     * </p>
     *
     * @param ip                              å®¢æˆ·ç«¯ IP åœ°å€
     * @param credentialData                  å‡­è¯æ•°æ®å¯¹è±¡
     * @param clientVerifierDataObject        å®¢æˆ·ç«¯éªŒè¯æ•°æ®å¯¹è±¡
     * @param serverVerifierDataObject        æœåŠ¡å™¨éªŒè¯æ•°æ®å¯¹è±¡
     * @return éªŒè¯ç»“æœ
     */
    @Override
    public boolean validate(String ip, CredentialData credentialData, Object clientVerifierDataObject, Object serverVerifierDataObject) throws Exception {
        /*
         * è·å– ServerVerifierDataAPI å¯¹è±¡å¹¶èµ‹å€¼äºç§æœ‰æˆå‘˜å˜é‡ serverVerifierDataAPI
         * ServerVerifierDataAPI æä¾›äº†å¯¹ ServerVerifierData å¯¹è±¡ç‰¹å®šå±æ€§çš„ getter åŠ setter æ–¹æ³•
         *
         * ServerVerifierDataAPI å«æœ‰ä¸¤ä¸ªæ„é€ ï¼Œåˆ†åˆ«ä¼ å…¥ serverVerifierDataObject æˆ– serverVerifierDataString
         * è‹¥é€šè¿‡ serverVerifierDataString è¿›è¡Œæ„é€ åˆ™éœ€è¦ try-catch æ•è·å¼‚å¸¸æˆ–æŠ›å‡ºï¼Œåœ¨æœ‰ Object çš„æƒ…å†µä¸‹æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨å­—ç¬¦ä¸²è¿›è¡Œæ„é€ 
         */
        serverVerifierDataAPI = new ServerVerifierDataAPI(serverVerifierDataObject);

        /*
         * CredentialData æ˜¯å‡­è¯æ•°æ®å¯¹è±¡ï¼Œå¯ä»¥åœ¨æ­¤å¯¹è±¡å†…è·å–ä¸€äº›å‡­è¯ä¿¡æ¯
         *
         * String file = credentialData.getFile(); // è®¸å¯è¯æ–‡ä»¶å†…å®¹
         * String hwid = credentialData.getHwid(); // Hwid
         * String fileName = credentialData.getFileName(); // è®¸å¯è¯æ–‡ä»¶å
         * String extraData = credentialData.getExtraData(); // å®¢æˆ·ç«¯é¢å¤–æ•°æ®
         */

        /*
         * é€šè¿‡ getter æ–¹æ³•è·å–æ­¤è®¸å¯è¯çš„æœ‰å…³ä¿¡æ¯
         * æˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨ serverVerificationInfo å˜é‡ï¼Œè¿™é‡Œä½¿ç”¨ SuppressWarnings æ³¨è§£æŠ‘åˆ¶è¯¥å˜é‡çš„æœªä½¿ç”¨è­¦å‘Š
         */
        @SuppressWarnings("unused")
        String serverVerificationInfo = serverVerifierDataAPI.getVerificationInfo();

        /*
         * ClientVerifierDataAPI æ„é€ å™¨ä¸ ServerVerifierDataAPI ç›¸åŒ
         * ClientVerifierDataAPI å¹¶ä¸æä¾›å¯¹åº”çš„ setter æ–¹æ³•ï¼Œå› ä¸ºè¿™äº›æ•°æ®éƒ½å­˜åœ¨äºå®¢æˆ·ç«¯æ–‡ä»¶ä¸­
         */
        ClientVerifierDataAPI clientVerifierDataAPI = new ClientVerifierDataAPI(clientVerifierDataObject);

        /*
         * åœ¨ä½¿ç”¨ ClientVerifierDataAPI çš„ getter æ–¹æ³•æ—¶ï¼Œé€šå¸¸éœ€è¦ä¼ å…¥ ServerVerifierData å¯¹è±¡
         * å› ä¸º ClientVerifierData å†…å®¹é™¤äº† UUID å‡æ˜¯éå¯¹ç§°åŠ å¯†ï¼Œå…¶å¯†é’¥å‡ä¿å­˜åœ¨å¯¹åº”çš„ ServerVerifierData ä¸­
         *
         * æˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨ clientVerificationInfo å˜é‡ï¼Œè¿™é‡Œä½¿ç”¨ SuppressWarnings æ³¨è§£æŠ‘åˆ¶è¯¥å˜é‡çš„æœªä½¿ç”¨è­¦å‘Š
         */
        @SuppressWarnings("unused")
        String clientVerificationInfo = clientVerifierDataAPI.getVerificationInfo(serverVerifierDataAPI.getServerVerifierData());

        /*
         * æ¥ä¸‹æ¥å®ç°ä¸€ä¸ªç®€å•çš„è¿‡æ»¤
         * å¦‚æœè®¸å¯è¯è®°å½•çš„ä½¿ç”¨è¿‡çš„ IP ä¸­å­˜åœ¨ 127.0.0.1 åˆ™è¿›è¡Œåˆ é™¤ï¼Œå¹¶ä¸”ä¸é€šè¿‡éªŒè¯
         * å¦‚æœ clientIp ä¹Ÿæ˜¯ 127.0.0.1 é‚£ä¹ˆä¹Ÿä¸é€šè¿‡éªŒè¯
         *
         * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯¹ serverVerifierDataObject è¿›è¡Œäº†æ›´æ”¹ï¼Œæ‰€ä»¥åœ¨ getServerVerifierData æ–¹æ³•éœ€è¦è¿”å›æˆ‘ä»¬æ›´æ”¹åçš„å¯¹è±¡
         */
        return !serverVerifierDataAPI.getIps().removeIf(ipaddress -> ipaddress.equals("127.0.0.1")) || !ip.equals("127.0.0.1");
    }

    /**
     * æƒé‡ï¼Œè¶Šä½è¶Šå…ˆæ‰§è¡Œã€‚
     *
     * <p>
     * èŒƒå›´åœ¨ {@code 20} ~ {@code 10000} ä¹‹é—´ã€‚
     * </p>
     *
     * <p>
     * è™½ç„¶æ‚¨å¯ä»¥æ³¨å†Œ {@code 20} ä»¥ä¸‹çš„æƒé‡ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨æœŸé—´ï¼Œæˆ‘æ°¸è¿œä¸ä¼šæ¨èæ‚¨è¿™ä¹ˆåšï¼Œé™¤éæ‚¨çœŸçš„çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆã€‚
     * </p>
     *
     * @return æƒé‡
     */
    @Override
    public int getWeight() {
        return 20;
    }

    /**
     * æ˜¯å¦å¿½ç•¥å¼‚å¸¸ã€‚
     *
     * <p>
     * è‹¥ä¸ºçœŸï¼Œå½“ {@link Validator#validate(String, CredentialData, Object, Object)} )} å‡ºç°å¼‚å¸¸æ—¶ç›´æ¥è¿”å› {@link Validator#getFailedMessage()}ï¼Œå¦åˆ™å°†æ‰“å°å¼‚å¸¸åè¿”å›ã€‚
     * </p>
     *
     * @return æ˜¯å¦å¿½ç•¥å¼‚å¸¸
     */
    @Override
    public boolean isIgnoreException() {
        return true;
    }

    /**
     * éªŒè¯å™¨åç§°ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * @return éªŒè¯å™¨åç§°
     */
    @Override
    public @NonNull String getName() {
        return "ExampleValidation";
    }

    /**
     * éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * <p>
     * æˆ‘ä»¬æ”¯æŒæ‚¨æ ¹æ®ä¸åŒçš„æ¡ä»¶åœ¨æ­¤å¤„è¿”å›ä¸åŒçš„ä¿¡æ¯ï¼Œä½†è¿™ç§åŠ¨æ€è¿”å›ä»…æ”¯æŒæ­¤æ–¹æ³•ä¸ {@link Validator#getServerVerifierData()} æ–¹æ³•ã€‚
     * å…¶ä½™æ–¹æ³•åŠ¨æ€è¿”å›å°†æ˜¯ä¸å®‰å…¨ä¸”ä¸æ¨èçš„åšæ³•ã€‚
     * </p>
     *
     * @return éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯
     */
    @Override
    public @NonNull String getFailedMessage() {
        return "EXAMPLE_VALIDATION";
    }

    /**
     * å¯¹äºæ­¤éªŒè¯å™¨çš„æè¿°ã€‚
     *
     * @return æè¿°
     */
    @Override
    public String getDescription() {
        return "ä¸€ä¸ªç®€æ˜“çš„è‡ªå®šä¹‰éªŒè¯å™¨";
    }

    /**
     * æœåŠ¡å™¨éªŒè¯æ•°æ®ã€‚
     *
     * <p>
     * å½“æ‚¨å°è¯•ä¿®æ”¹äº†æœåŠ¡å™¨éªŒè¯æ•°æ®æ—¶ï¼Œè¿™é‡Œå¿…é¡»ä¸ºæ‚¨ä¿®æ”¹åçš„å¯¹è±¡ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰ IO æ“ä½œã€‚
     * </p>
     *
     * <p>
     * è‹¥ä¸º {@code null} åˆ™ä¸ºæœªè¿›è¡Œä¿®æ”¹ï¼Œè‹¥æœªç©º {@code ""} åˆ™æœªåˆ é™¤è¯¥ç”¨æˆ·çš„æ•°æ®ã€‚
     * </p>
     *
     * @return æœåŠ¡å™¨éªŒè¯æ•°æ®
     */
    @Override
    public Object getServerVerifierData() {
        return serverVerifierDataAPI.getServerVerifierData();
    }
}
```

---

## æ³¨å†ŒéªŒè¯å™¨

æ‚¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ³¨å†ŒéªŒè¯å™¨ï¼Œä¸å¿…å¿…é¡»åœ¨å…¥å£æ–¹æ³•ï¼Œä½†è¯·ç¡®ä¿å…¶å¯ä»¥åˆ°è¾¾ã€‚

```java
ValidatorManager.getValidatorManager().registerValidator(new ExampleValidation());
```

---