# ğŸš€ CryptoVerifier

---

## æ’ä»¶å¼€å‘

è¯¥ç¯‡æ¡ˆä¾‹è®²è§£å°†ä¼šä»æ„æ€åˆ°å®ç°ï¼Œå®Œæˆä¸€æ•´ä¸ªæ’ä»¶å¼€å‘æµç¨‹ã€‚

---

## éœ€æ±‚

é€šå¸¸ï¼Œæˆ‘ä»¬ä¹Ÿè®¸ä¼šæœ‰å¤šä¸ªäº§å“éœ€è¦ä¾èµ–äºæ­¤éªŒè¯ç³»ç»Ÿï¼Œä½†å¤šå¼€ `CryptoVerifier` æœåŠ¡è¿‡äºéº»çƒ¦ï¼Œä¸”å ç”¨èµ„æºè¿‡å¤šã€‚

è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨å®¢æˆ·ç«¯æ–¹çš„ `ExtraData` åŠŸèƒ½ä¸æ’ä»¶é…åˆï¼Œä»¥è¾¾æˆä¸€è®¸å¯è¯éªŒè¯ä¸€äº§å“çš„å½¢å¼ã€‚

---

## Maven ä¾èµ–

`CryptoVerifier` çš„éªŒè¯ç«¯ä½¿ç”¨äº†è¿™äº›ä¾èµ–:

- [Lombok](https://projectlombok.org/setup/maven) - ç®€åŒ–ä»£ç 
- [sl4j](https://mvnrepository.com/artifact/org.slf4j/slf4j-api) - æ—¥å¿—è¾“å‡º

é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ‚¨å¼•å…¥

- `CryptoVerifier-Commons`
- `CryptoVerifier-Commons-Server`
- `CryptoVerifier-CoreAPI`
- `CryptoVerifier-EventAPI`
- `CryptoVerifier-ValidationAPI`

ä¾èµ–ï¼Œå…³äºè¿™äº›ä¾èµ–ä¿¡æ¯å¯ä»¥åœ¨ `æ’ä»¶å¼€å‘å…¥é—¨` æ‰¾åˆ°ã€‚

ç”±äºè¿™äº›ä¾èµ–å¹¶ä¸éœ€è¦æ‰“åŒ…è¿›æ’ä»¶ï¼Œç›´æ¥å¼•å…¥å³å¯:

```xml
<dependencies>
    <!-- https://projectlombok.org/setup/maven -->
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <version>1.18.26</version>
        <scope>provided</scope>
    </dependency>

    <!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>2.0.7</version>
        <scope>provided</scope>
    </dependency>

    <!-- CryptoVerifier-Commons åº“ï¼Œç”¨äºç½‘ç»œè¯·æ±‚ä¸åŠ å¯†è§£å¯† -->
    <dependency>
        <groupId>twomillions.other.cryptoverifier</groupId>
        <artifactId>CryptoVerifier-Commons</artifactId>
        <version>1.0.0</version>
        <scope>system</scope>
        <systemPath>${project.basedir}/../../../../CryptoVerifier-Commons/target/CryptoVerifier-Commons-1.0.0.jar</systemPath>
    </dependency>

    <!-- CryptoVerifier-Commons-Server åº“ï¼Œæä¾›çº¿ç¨‹æ± ã€æ—¥å¿—è®°å½•å™¨ã€æ’ä»¶å…¥å£æ¥å£å’Œæšä¸¾ç±»ç­‰ -->
    <dependency>
        <groupId>twomillions.other.cryptoverifier</groupId>
        <artifactId>CryptoVerifier-Commons-Server</artifactId>
        <version>1.0.2</version>
        <scope>system</scope>
        <systemPath>${project.basedir}/../../../../CryptoVerifier-Commons-Server/target/CryptoVerifier-Commons-Server-1.0.2.jar</systemPath>
    </dependency>

    <!-- CryptoVerifier-CoreAPI åº“ï¼Œæä¾›äº†è®¿é—® CryptoVerifier éƒ¨åˆ†å†…éƒ¨æ–¹æ³•çš„èƒ½åŠ› -->
    <dependency>
        <groupId>twomillions.other.cryptoverifier</groupId>
        <artifactId>CryptoVerifier-CoreAPI</artifactId>
        <version>1.0.0</version>
        <scope>system</scope>
        <systemPath>${project.basedir}/../../../../CryptoVerifier-CoreAPI/target/CryptoVerifier-CoreAPI-1.0.0.jar</systemPath>
    </dependency>

    <!-- CryptoVerifier-EventAPI åº“ï¼Œæä¾›äº‹ä»¶çš„å®ç°å’Œæ³¨å†Œç›‘å¬å™¨çš„åŠŸèƒ½ -->
    <dependency>
        <groupId>twomillions.other.cryptoverifier</groupId>
        <artifactId>CryptoVerifier-EventAPI</artifactId>
        <version>1.1.1</version>
        <scope>system</scope>
        <systemPath>${project.basedir}/../../../../CryptoVerifier-EventAPI/target/CryptoVerifier-EventAPI-1.1.1.jar</systemPath>
    </dependency>

    <!-- CryptoVerifier-ValidationAPI åº“ï¼Œæä¾›äº‹ä»¶çš„å®ç°å’Œæ³¨å†Œç›‘å¬å™¨çš„åŠŸèƒ½ -->
    <dependency>
        <groupId>twomillions.other.cryptoverifier</groupId>
        <artifactId>CryptoVerifier-ValidationAPI</artifactId>
        <version>1.1.0</version>
        <scope>system</scope>
        <systemPath>${project.basedir}/../../../../CryptoVerifier-ValidationAPI/target/CryptoVerifier-ValidationAPI-1.1.0.jar</systemPath>
    </dependency>
</dependencies>
```

è¿™äº›ä¾èµ–ç‰ˆæœ¬å·å¯èƒ½å¹¶ä¸æ˜¯æœ€æ–°çš„ï¼Œå¦‚æœ‰éœ€è¦ï¼Œæ‚¨éœ€è¦è‡ªè¡Œæ›´æ”¹ç‰ˆæœ¬å·ã€‚

ç”±äºè¿™æ˜¯æ’ä»¶ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¯´æ˜ä¸»ç±»ï¼Œåªéœ€è¦å®ç°æ¥å£å¹¶é‡å†™å…¥å£æ–¹æ³•å³å¯ã€‚


---

## æ’ä»¶å®ç°

ç›®å‰æˆ‘ä»¬å·²ç»é…ç½®å¥½äº† Mavenï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å†æ¬¡è¿›è¡Œè¯¦ç»†çš„æ„æ€:

`CryptoVerifier` åœ¨ç”Ÿæˆè®¸å¯è¯æ—¶ï¼Œéœ€è¦æä¾› `Info` é¡¹ï¼Œä¸”æ­¤é¡¹ä¼šä½¿ç”¨ `RSA` åŠ å¯†åä¿å­˜åœ¨å®¢æˆ·ç«¯è®¸å¯è¯ä¸­ã€‚

æˆ‘ä»¬å¯ä»¥è®©å®¢æˆ·ç«¯åœ¨ `ExtraData` ä¸­æºå¸¦äº§å“çš„å…·ä½“ä¿¡æ¯ï¼Œæ¯”å¦‚åç§°ï¼Œåœ¨ç”Ÿæˆè®¸å¯è¯æ—¶å¡«å†™ `Info` é¡¹ï¼Œä½¿å…¶åŒ…å«äº§å“ä¿¡æ¯ï¼Œåœ¨éªŒè¯æ—¶åˆ¤æ–­ `ExtraData` ä¸ `Info` å³å¯ã€‚

å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ç§ç®€å•çš„å®ç°ï¼Œ`CryptoVerifier` å…è®¸æ‚¨ä½¿ç”¨ API åœ¨åˆ›å»ºè®¸å¯è¯æ—¶è‡ªå®šä¹‰ `CustomData` é¡¹ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒï¼Œè¿™æ˜¯å¦ä¸€ç§æ€è·¯ã€‚

æ¥ä¸‹æ¥è®©æˆ‘ä»¬å…ˆå®ç°æ’ä»¶å…¥å£:

```java
/**
 * æ’ä»¶å…¥å£ï¼Œåº”å®ç° {@link EntryPointInterface} é‡å†™ onLoad æ–¹æ³•ã€‚
 *
 * @author 2000000
 * @version 1.0
 * @since 2023/8/15
 */
@SuppressWarnings("unused")
public class Main implements EntryPointInterface {
    /**
     * å…¥å£æ–¹æ³•ã€‚
     */
    @Override
    public void onLoad() {
        LoggerUtils.getLogger().info("[Plugin] æ’ä»¶å·²åŠ è½½!");
    }
}
```

ä¸ºäº†å®ç°æˆ‘ä»¬è‡ªå·±çš„éªŒè¯æƒ³æ³•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªéªŒè¯å™¨:

```java
/**
 * ç¤ºä¾‹è‡ªå®šä¹‰éªŒè¯å™¨ï¼Œåº”å®ç° {@link Validator} é‡å†™æ‰€æœ‰æ–¹æ³•ã€‚
 *
 * @author 2000000
 * @version 1.0
 * @since 2023/8/15
 */
public class Validation implements Validator {
    /**
     * éªŒè¯æ–¹æ³•ã€‚
     *
     * <p>
     * æ³¨æ„ï¼Œæ­¤å¤„çš„ {@code serverVerifierDataObject} ä¼šæŒç»­æ›´æ–°ï¼Œ
     * ä¿è¯ä¸‹ä¸€ä¸ªéªŒè¯å™¨æ”¶åˆ°çš„æ˜¯ä¸Šä¸€ä¸ªéªŒè¯å™¨è¿”å›çš„æœ€æ–°æ•°æ®ã€‚ä½†çœŸæ­£çš„ IO æ“ä½œåªæœ‰æ‰€æœ‰éªŒè¯é€šè¿‡æ‰ä¼šè¿›è¡Œã€‚
     * </p>
     *
     * @param ip                              å®¢æˆ·ç«¯ IP åœ°å€
     * @param credentialData                  å‡­è¯æ•°æ®å¯¹è±¡
     * @param clientVerifierDataObject        å®¢æˆ·ç«¯éªŒè¯æ•°æ®å¯¹è±¡
     * @param serverVerifierDataObject        æœåŠ¡å™¨éªŒè¯æ•°æ®å¯¹è±¡
     * @return éªŒè¯ç»“æœ
     */
    @Override
    public boolean validate(String ip, CredentialData credentialData, Object clientVerifierDataObject, Object serverVerifierDataObject) throws Exception {
        ServerVerifierDataAPI serverVerifierDataAPI = new ServerVerifierDataAPI(serverVerifierDataObject);

        String extraData = credentialData.getExtraData();
        String verificationInfo = serverVerifierDataAPI.getVerificationInfo();

        if (extraData == null || extraData.isEmpty()) {
            return false;
        }

        return verificationInfo.contains(extraData);
    }

    /**
     * æƒé‡ï¼Œè¶Šä½è¶Šå…ˆæ‰§è¡Œã€‚
     *
     * <p>
     * èŒƒå›´åœ¨ {@code 20} ~ {@code 10000} ä¹‹é—´ã€‚
     * </p>
     *
     * <p>
     * è™½ç„¶æ‚¨å¯ä»¥æ³¨å†Œ {@code 20} ä»¥ä¸‹çš„æƒé‡ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨æœŸé—´ï¼Œæˆ‘æ°¸è¿œä¸ä¼šæ¨èæ‚¨è¿™ä¹ˆåšï¼Œé™¤éæ‚¨çœŸçš„çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆã€‚
     * </p>
     *
     * @return æƒé‡
     */
    @Override
    public int getWeight() {
        return 20;
    }

    /**
     * æ˜¯å¦å¿½ç•¥å¼‚å¸¸ã€‚
     *
     * <p>
     * è‹¥ä¸ºçœŸï¼Œå½“ {@link Validator#validate(String, CredentialData, Object, Object)} )} å‡ºç°å¼‚å¸¸æ—¶ç›´æ¥è¿”å› {@link Validator#getFailedMessage()}ï¼Œå¦åˆ™å°†æ‰“å°å¼‚å¸¸åè¿”å›ã€‚
     * </p>
     *
     * @return æ˜¯å¦å¿½ç•¥å¼‚å¸¸
     */
    @Override
    public boolean isIgnoreException() {
        return true;
    }

    /**
     * éªŒè¯å™¨åç§°ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * @return éªŒè¯å™¨åç§°
     */
    @Override
    public @NonNull String getName() {
        return "ProductCheck";
    }

    /**
     * éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯ã€‚æ­¤é¡¹ä¸èƒ½ä¸ºç©ºã€‚
     *
     * <p>
     * æˆ‘ä»¬æ”¯æŒæ‚¨æ ¹æ®ä¸åŒçš„æ¡ä»¶åœ¨æ­¤å¤„è¿”å›ä¸åŒçš„ä¿¡æ¯ï¼Œä½†è¿™ç§åŠ¨æ€è¿”å›ä»…æ”¯æŒæ­¤æ–¹æ³•ä¸ {@link Validator#getServerVerifierData()} æ–¹æ³•ã€‚
     * å…¶ä½™æ–¹æ³•åŠ¨æ€è¿”å›å°†æ˜¯ä¸å®‰å…¨ä¸”ä¸æ¨èçš„åšæ³•ã€‚
     * </p>
     *
     * @return éªŒè¯å¤±è´¥æ—¶è¿”å›çš„ä¿¡æ¯
     */
    @Override
    public @NonNull String getFailedMessage() {
        return "PRODUCT_CHECK";
    }

    /**
     * å¯¹äºæ­¤éªŒè¯å™¨çš„æè¿°ã€‚
     *
     * @return æè¿°
     */
    @Override
    public String getDescription() {
        return "äº§å“æ£€æŸ¥";
    }

    /**
     * æœåŠ¡å™¨éªŒè¯æ•°æ®ã€‚
     *
     * <p>
     * å½“æ‚¨å°è¯•ä¿®æ”¹äº†æœåŠ¡å™¨éªŒè¯æ•°æ®æ—¶ï¼Œè¿™é‡Œå¿…é¡»ä¸ºæ‚¨ä¿®æ”¹åçš„å¯¹è±¡ï¼Œå¦åˆ™å°†ä¸ä¼šæœ‰ IO æ“ä½œã€‚
     * </p>
     *
     * <p>
     * è‹¥ä¸º {@code null} åˆ™ä¸ºæœªè¿›è¡Œä¿®æ”¹ï¼Œè‹¥æœªç©º {@code ""} åˆ™æœªåˆ é™¤è¯¥ç”¨æˆ·çš„æ•°æ®ã€‚
     * </p>
     *
     * @return æœåŠ¡å™¨éªŒè¯æ•°æ®
     */
    @Override
    public Object getServerVerifierData() {
        return null;
    }
}
```

é¦–å…ˆæˆ‘ä»¬å®ç° `Validator` æ¥å£ï¼Œé‡å†™ `getWeight` æ–¹æ³•ï¼Œæƒé‡ä¸º `20`ï¼Œé‡å†™ `isIgnoreException` æ–¹æ³•ï¼Œå¿½ç•¥å¼‚å¸¸ã€‚é‡å†™ `getName` æ–¹æ³•ï¼Œè¿”å›åç§°ä¸º `ProductCheck`ï¼Œé‡å†™ `getFailedMessage` æ–¹æ³•ï¼Œè¿”å›å¤±è´¥ä¿¡æ¯ä¸º `PRODUCT_CHECK`ï¼Œé‡å†™ `getDescription` æ–¹æ³•ï¼Œè¿”å›æè¿°ä¸º `äº§å“æ£€æŸ¥`ã€‚

å› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰å¯¹æœåŠ¡å™¨éªŒè¯æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ `getServerVerifierData` æ–¹æ³•ä¿æŒè¿”å› `null` å³å¯ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦é‡å†™ `validate` æ–¹æ³•ï¼Œä¼ å…¥ `serverVerifierDataObject` æ„å»ºä¸€ä¸ª `ServerVerifierDataAPI` å¯¹è±¡ä»¥è·å– `Info` å­—æ®µã€‚

é€šè¿‡ `CredentialData` å¯¹è±¡è·å– `ExtraData`ï¼Œéšåè¿›è¡Œåˆ¤æ–­ï¼Œè‹¥ `ExtraData` ä¸º `null` æˆ–è€…ä¸ºç©ºåˆ™è¿”å›éªŒè¯å¤±è´¥ï¼Œè‹¥ `Info` å­—æ®µå†…åŒ…å« `ExtraData` åˆ™è¿”å› `true`ã€‚

æˆ‘ä»¬å·²ç»å®Œæˆäº†éªŒè¯å™¨ï¼Œè®©æˆ‘ä»¬æ³¨å†Œå®ƒ:

```java
    /**
     * å…¥å£æ–¹æ³•ã€‚
     */
    @Override
    public void onLoad() {
        LoggerUtils.getLogger().info("[Plugin] æ’ä»¶å·²åŠ è½½!");
        ValidatorManager.getValidatorManager().registerValidator(new Validation());
    }
```

å®Œæˆã€‚

---

## å®¢æˆ·ç«¯å®ç°

ç°åœ¨æˆ‘ä»¬å·²ç»å†™å¥½äº†é¢å¤–çš„äº§å“éªŒè¯ï¼Œæˆ‘ä»¬éœ€è¦è®©å®¢æˆ·ç«¯åœ¨å‘é€æ•°æ®æ—¶å‘é€ `ExtraData`ï¼Œä»¥ `10.1` ä¸ºä¾‹ï¼Œåªéœ€è¦è¿™æ ·åš:

```java
    /**
     * æ¯éš” 5min å‘é€ä¸€æ¬¡éªŒè¯è¯·æ±‚è¿›è¡Œå ä½ã€‚
     *
     * <p>
     * æ­¤å¤„æ–°å¼€çº¿ç¨‹å®ç°ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ‚¨è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œæˆ–æ‚¨ä¸º Minecraft å¼€å‘æ’ä»¶ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä»¬çš„çº¿ç¨‹æ± è¿›è¡Œè°ƒåº¦ã€‚
     * </p>
     */
    @SuppressWarnings({"BusyWait", "InfiniteLoopStatement"})
    private static void startVerifyThread() {
        Runnable runnable = () -> {
            Verifier verifier = new Verifier();

            try {
                while (true) {
                    // å‘é€é¢å¤–æ•°æ®ä¸ºæˆ‘ä»¬çš„äº§å“å
                    verify(verifier, "Hello");
                    Thread.sleep(300000);
                }
            } catch (Exception exception) {
                exception.printStackTrace();
                System.out.println("éªŒè¯æ—¶å‡ºé”™! å³å°†é€€å‡ºç¨‹åº, è¯·åé¦ˆç»™å¼€å‘è€…!");
                System.exit(0);
            }
        };

        new Thread(runnable).start();
    }

    /**
     * å¿«é€ŸéªŒè¯æ–¹æ³•ã€‚
     *
     * @param verifier {@link Verifier} å¯¹è±¡
     * @param extraData é¢å¤–æ•°æ®
     * @throws Exception è·å–éªŒè¯å†…å®¹æˆ–éªŒè¯æ—¶å‘ç”Ÿå¼‚å¸¸
     */
    private static void verify(Verifier verifier, @SuppressWarnings("SameParameterValue") String extraData) throws Exception {
        File file = new File(filePath, fileName);
        String fileString = FileUtils.readFileToString(file, "UTF-8");
        String hwid = HardwareInfoManager.getMachineIdentifier();

        CredentialData credentialData = new CredentialData(
                fileString, fileName, hwid, extraData
        );

        verifier.setIps(ips);
        verifier.setCredentialData(credentialData);

        verifier.verify();
    }
```

---

## å®‰å…¨æ€§æé†’

å°½ç®¡æˆ‘ä»¬æ”¯æŒæ‚¨é€šè¿‡ `ExtraData` æ¥ç®€å•çš„å®Œæˆä¸€äº›æ“ä½œï¼Œä½†æ˜¯æ‚¨å¿…é¡»è¦çŸ¥é“çš„æ˜¯ï¼Œ**æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯ç»ä¸èƒ½å®Œå…¨ä¿¡ä»»**ã€‚

é»‘å®¢å¯ä»¥å¾ˆç®€å•çš„é€šè¿‡é€†å‘æ¥æ§åˆ¶ `ExtraData` å­—æ®µå†…å®¹ï¼Œäº¦æˆ–è€…é€šè¿‡æŠ“å– `ExtraData` å­—æ®µæ¥ç»•è¿‡è¿™ä¸€æ£€æµ‹ï¼Œè‹¥èµ„æºè¶³å¤Ÿï¼Œæˆ‘ä»¬ä»ç„¶å»ºè®®åœ¨è¿™ç§æƒ…å†µä¸‹æ–°å¼€æœåŠ¡ã€‚

---